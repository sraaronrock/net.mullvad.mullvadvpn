app-id: net.mullvad.mullvadvpn
runtime: org.freedesktop.Platform
runtime-version: '24.08'
base: org.freedesktop.Sdk
base-version: '24.08'
sdk: org.freedesktop.Sdk
command: mullvad
separate-locales: false
finish-args:
  - --socket=wayland
  - --socket=fallback-x11
  - --device=dri
  - --share=ipc
  - --share=network
  - --talk-name=org.freedesktop.NetworkManager
  - --talk-name=org.freedesktop.secrets
  - --talk-name=org.kde.StatusNotifierWatcher
modules:
  - name: mullvad
    buildsystem: simple
    build-commands:
      - bsdtar -Oxf mullvad.deb 'data.tar.xz' | bsdtar -xf -
      - install -Dm755 usr/bin/mullvad $FLATPAK_DEST/bin/mullvad
      - desktop-file-edit --set-key=Exec --set-value="mullvad %U" net.mullvad.mullvadvpn.desktop
      - desktop-file-edit --set-icon=net.mullvad.mullvadvpn net.mullvad.mullvadvpn.desktop
      - install -Dm644 net.mullvad.mullvadvpn.desktop $FLATPAK_DEST/share/applications/net.mullvad.mullvadvpn.desktop
      - install -Dm644 mullvad.png $FLATPAK_DEST/share/icons/hicolor/512x512/apps/net.mullvad.mullvadvpn.png
      - install -Dm644 net.mullvad.mullvadvpn.metainfo.xml $FLATPAK_DEST/share/metainfo/net.mullvad.mullvadvpn.metainfo.xml
    sources:
      - type: extra-data
        url: https://github.com/mullvad/mullvadvpn-app/releases/download/2025.10/MullvadVPN-2025.10_amd64.deb
        sha256: 3afd935b8e4c37fb7e746b87f884dbca6ee19efdba524daebf0d25238e17bf11
        only-arches: [x86_64]
        dest-filename: mullvad.deb
      - type: extra-data
        url: https://github.com/mullvad/mullvadvpn-app/releases/download/2025.10/MullvadVPN-2025.10_arm64.exe
        sha256: ed3abb02e575590f9eca0d5772db74995eba69e6bdb214b63ef8f38abe654e56
        only-arches: [aarch64]
        dest-filename: mullvad.deb
      - type: file
        path: net.mullvad.mullvadvpn.metainfo.xml
      - type: file
        path: net.mullvad.mullvadvpn.desktop
      - type: file
        path: mullvad.png
